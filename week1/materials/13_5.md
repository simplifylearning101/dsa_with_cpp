# Deep Dive into Advanced STL Algorithms and Function Objects

This document provides an advanced exploration of STL algorithms and function objects for coding interviews. It covers internals, advanced applications, and interview questions, building on Hours 1–12.

## Agenda
- Explore internals of advanced STL algorithms.  
- Demonstrate complex scenarios with containers and functors.  
- Prepare for interviews with challenging questions.

## Outcome Expected
Students will:  
- Understand algorithm internals (e.g., `remove_if` mechanics).  
- Master advanced applications (e.g., complex transformations).  
- Optimize algorithm usage with containers.  
- Answer complex interview questions confidently.

## Topics Covered
1. **Algorithm Internals**  
   - How `for_each`, `transform`, `remove_if`, `partition` work.  
   - Iterator requirements and performance.  
   - Real-world analogy: Algorithms as specialized workers.  
2. **Advanced Applications**  
   - Combining algorithms with functors/lambdas.  
   - Multi-container operations.  
3. **Optimization and Pitfalls**  
   - Avoiding iterator invalidation.  
   - Choosing optimal algorithms and functors.  

## Detailed Explanation

### 1. Algorithm Internals
- **for_each**: Applies function to each element, O(n).  
- **transform**: Applies function, stores results, O(n).  
- **remove_if**: Shifts elements not satisfying predicate, O(n).  
- **partition**: Rearranges based on predicate, O(n).

**Example Program**: Combining algorithms.

```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

int main() {
    vector<int> v = {1, 2, 3, 4, 5};
    // Transform to double
    transform(v.begin(), v.end(), v.begin(), [](int x) { return x * 2; });
    // Remove > 5
    auto new_end = remove_if(v.begin(), v.end(), [](int x) { return x > 5; });
    v.erase(new_end, v.end());
    // Print
    for_each(v.begin(), v.end(), [](int x) { cout << x << " "; });
    cout << endl;  // Output: 2 4
    return 0;
}
```

**Explanation**:  
- Chains `transform`, `remove_if`, `for_each`.  
- `remove_if` requires `erase` for actual removal.

### 2. Advanced Applications
Use functors and lambdas for complex operations across containers.

**Example Program**: Functor with state.

```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

struct SumEven {
    int sum = 0;
    void operator()(int x) { if (x % 2 == 0) sum += x; }
};

int main() {
    vector<int> v = {1, 2, 3, 4};
    SumEven se = for_each(v.begin(), v.end(), SumEven());
    cout << "Sum of evens: " << se.sum << endl;  // Output: 6
    return 0;
}
```

**Explanation**:  
- Functor maintains state (`sum`).  
- `for_each` returns functor for result.

### 3. Optimization and Pitfalls
- **Optimization**: Use lambdas for simple predicates; functors for stateful operations.  
- **Pitfalls**: Avoid modifying containers during `for_each`; use `erase` after `remove_if`.

**Example Program**: Safe usage.

```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

int main() {
    vector<int> v = {1, -2, 3, -4};
    partition(v.begin(), v.end(), [](int x) { return x > 0; });
    cout << "Partitioned: ";
    for (int x : v) cout << x << " ";  // Output: 1 3 -2 -4
    cout << endl;
    return 0;
}
```

**Explanation**:  
- `partition` is safe for vectors.  
- Avoids iterator invalidation.

## Interview Questions and Answers
Below are 15 advanced interview questions.

1. **Question**: What is the time complexity of `remove_if`?  
   **Answer**: O(n) for shifting elements.  
   **Interviewer’s Intention**: Tests algorithm knowledge.

2. **Question**: Why use a functor over a lambda?**  
   **Answer**: Functors maintain state; lambdas are stateless unless capturing.  
   **Interviewer’s Intention**: Tests functor usage.

3. **Question**: Write a program to double vector elements.  
   **Answer**: (See homework solution 2.)  
   **Interviewer’s Intention**: Tests `transform`.

4. **Question**: What happens if you don’t call `erase` after `remove_if`?**  
   **Answer**: Elements are shifted, size unchanged.  
   **Interviewer’s Intention**: Tests algorithm mechanics.

5. **Question**: How do you partition a vector by even/odd?**  
   **Answer**: (See homework solution 4.)  
   **Interviewer’s Intention**: Tests `partition`.

6. **Question**: What is the difference between `for_each` and `transform`?**  
   **Answer**: `for_each` for side effects; `transform` stores results.  
   **Interviewer’s Intention**: Tests algorithm roles.

7. **Question**: Write a program to count strings > 3 chars.  
   **Answer**: (See homework solution 7.)  
   **Interviewer’s Intention**: Tests `count_if`.

8. **Question**: What iterator type does `partition` require?**  
   **Answer**: Bidirectional.  
   **Interviewer’s Intention**: Tests iterator knowledge.

9. **Question**: Why is `<functional>` needed?**  
   **Answer**: For predefined functors like `plus`.  
   **Interviewer’s Intention**: Tests header knowledge.

10. **Question**: Write a program to transform strings to uppercase.  
    **Answer**: (See homework solution 12.)  
    **Interviewer’s Intention**: Tests `transform`.

11. **Question**: What is a predicate?**  
    **Answer**: Function returning bool.  
    **Interviewer’s Intention**: Tests functional concepts.

12. **Question**: Can `remove_if` be used on a map?**  
    **Answer**: No, map is immutable for such operations.  
    **Interviewer’s Intention**: Tests container properties.

13. **Question**: Write a program to sum even numbers using a functor.  
    **Answer**: (See homework solution 5.)  
    **Interviewer’s Intention**: Tests functors.

14. **Question**: What is the space complexity of `transform`?**  
    **Answer**: O(1) excluding output storage.  
    **Interviewer’s Intention**: Tests complexity.

15. **Question**: How do you avoid iterator invalidation?**  
    **Answer**: Avoid modifying container structure during iteration.  
    **Interviewer’s Intention**: Tests error handling.

## Practice Recommendations
- Solve LeetCode problems like **Contains Duplicate** and **3Sum**.  
- Experiment with functors for stateful operations.  
- Combine multiple algorithms in one program.